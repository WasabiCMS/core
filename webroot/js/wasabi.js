define("common/BaseViewFactory",["require","underscore"],function(e){var i=e("underscore"),s=function(e){this.eventBus=e,this.registry={factory:this}};return s.prototype=i.extend({},{register:function(e,i){return this.registry[e]=i,this.registry[e]},create:function(e,s){var t,n;return s=s||{},n=i.extend(s,this.registry,{eventBus:this.eventBus}),t=e,t.prototype.eventBus=this.eventBus,new t(n)}}),s}),define("wasabi",["require","jquery","underscore","backbone","./common/BaseViewFactory","bootstrap.dropdown"],function(e){var i=e("jquery"),s=e("underscore"),t=e("backbone"),n=e("./common/BaseViewFactory");e("bootstrap.dropdown");var a=s.extend({},t.Events),o=new n(a),r=0,l="undefined";if(typeof window.WS!==l)return window.WS;var u={features:{},modules:{registered:[]},views:[],eventBus:a,viewFactory:o,boot:function(){function t(i){var s=i.name,t=i.require,a=i.options;e([t],function(e){n.modules[s]=e,n.modules[s].initialize(a)})}for(var n=this,a=0,o=this.modules.registered.length;o>a;a++)t(this.modules.registered[a]);i(window).on("resize",function(){clearTimeout(r),r=setTimeout(s.bind(function(){this.eventBus.trigger("window.resize")},this),100)})},registerModule:function(e,i){this.modules.registered.push({name:e,require:e,options:i||{}})},get:function(e){return this.modules[e]?this.modules[e]:void console.debug('module "'+e+" is not registered.")},createView:function(e,i){return this.viewFactory.create(e,i||{})},createViews:function(e,i,t){var n=[];return e.length>0&&e.each(function(e,a){n.push(u.createView(i,s.extend({el:a},t||{})))}),n}};return window.WS=u,u}),define("core/views/Menu",["require","jquery","wasabi.BaseView","wasabi"],function(e){var i=e("jquery"),s=e("wasabi.BaseView"),t=(e("wasabi"),{collapsedClass:"collapsed",openClass:"open",popoutClass:"popout"}),n=function(e,s){var t=i(e.target);return t.is("li")?t:(s=s||"",t.closest("li"+s))};return s.extend({el:"#backend-menu > ul",events:function(){var e={"click > li:has(ul) > a":"onMainItemClick"};return this.isCollapsed&&(e=i.extend(e,{"mouseenter > li":"onMainItemMouseenter","mouseleave > li":"onMainItemMouseleave"})),e},globalEvents:{"window.resize":"collapseMenu"},isCollapsed:!1,options:{},initialize:function(e){this.options=i.extend({},t,e),this.$("> li").filter(".active").prev().addClass("prev-active"),this.collapseMenu()},collapseMenu:function(){var e=this.isCollapsed;this.isCollapsed="none"===this.$("> li > a > .item-name").first().css("display"),this.isCollapsed?(this.$el.addClass(this.options.collapsedClass),this.isCollapsed!==e&&this.delegateEvents(this.events())):(this.$el.removeClass(this.options.collapsedClass),this.delegateEvents(this.events()))},onMainItemClick:function(e){n(e).toggleClass(this.options.openClass)},onMainItemMouseenter:function(e){this.isCollapsed&&n(e).addClass(this.options.popoutClass)},onMainItemMouseleave:function(e){this.isCollapsed&&n(e,"."+this.options.popoutClass).removeClass(this.options.popoutClass)},onResize:function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(_.bind(this.collapseMenu,this),100)}})}),define("core/views/NavigationToggle",["require","jquery","wasabi.BaseView"],function(e){var i=e("jquery"),s=e("wasabi.BaseView"),t=i("body"),n={navClosedClass:"nav-closed"};return s.extend({el:"body > header .toggle-nav",events:{click:"toggleNav"},isClosed:!1,options:{},initialize:function(e){this.options=i.extend({},n,e),this.isClosed=t.hasClass(this.options.navClosedClass)},toggleNav:function(){this.closed?(t.removeClass(this.options.navClosedClass),this.closed=!1):(t.addClass(this.options.navClosedClass),this.closed=!0)}})}),define("core/views/LangSwitch",["require","underscore","wasabi.BaseView"],function(e){var i=e("underscore"),s=e("wasabi.BaseView");return s.extend({el:".lang-switch",globalEvents:{"wasabi-core--languages-sort":"updateLanguageLinkPositions"},updateLanguageLinkPositions:function(e,s){var t=s.frontendLanguages,n=[],a=this.$("li");i.each(t,function(e){n.push(a.filter('[data-language-id="'+e.id+'"]'))}),this.$el.html(n)}})}),define("core/views/Pagination",["require","jquery","wasabi.BaseView","purl"],function(e){var i=e("jquery"),s=e("wasabi.BaseView"),t=e("purl");return s.extend({el:".pagination",events:{"change .limit":"onChangeLimit"},onChangeLimit:function(e){var s=i(e.target),n=s.val(),a=s.attr("data-url"),o=t(window.location),r=s.attr("name").split("data[").join("").split("]").join(""),l=o.data.param.query;l[r]=n.toString();var u="",c=[];for(var d in l)l.hasOwnProperty(d)&&c.push(d+"="+l[d]);u=c.join("&"),""!==u&&(u="?"+u),window.location=a+u}})}),define("core/views/LanguagesTable",["require","jquery","wasabi.BaseView","wasabi","jquery.tSortable"],function(e){var i=e("jquery"),s=e("wasabi.BaseView"),t=e("wasabi");return e("jquery.tSortable"),s.extend({events:{"tSortable-change":"onSort"},initialize:function(){this.$form=this.$el.closest("form"),this.$el.tSortable({handle:"a.action-sort",placeholder:"sortable-placeholder",opacity:.8})},onSort:function(e){var s=i(e.target);s.find("tbody > tr").each(function(e){i(this).find("input.position").first().val(e)}),i.ajax({url:this.$form.attr("action"),data:this.$form.serialize(),type:"post",success:function(i){t.eventBus.trigger("wasabi-core--languages-sort",e,i)}})}})}),define("core/sections/LanguagesIndex",["require","wasabi.BaseView","wasabi","../views/LanguagesTable"],function(e){var i=e("wasabi.BaseView"),s=e("wasabi"),t=e("../views/LanguagesTable");return i.extend({el:".wasabi-core--languages-index",initialize:function(){s.createView(t,{el:this.$("table.languages")})}})}),define("wasabi.core",["require","jquery","underscore","core/views/Menu","core/views/NavigationToggle","core/views/LangSwitch","core/views/Pagination","wasabi","jquery.livequery","core/sections/LanguagesIndex"],function(e){function i(){l.ajaxSetup({dataType:"json"}),l(g).ajaxSuccess(s).ajaxError(t)}function s(e,i){if(200==i.status&&"OK"==i.statusText){var s=l.parseJSON(i.responseText)||{};"undefined"!=typeof s.status&&("undefined"!=typeof s.flash&&n(s.flash),"undefined"!=typeof s.redirect&&(w.location=s.redirect))}}function t(e,i){var s;401==i.status&&(s=l.parseJSON(i.responseText)||{},"undefined"!=typeof s.name&&(confirm(s.name),w.location.reload())),500==i.status&&(s=l.parseJSON(i.responseText)||{},"undefined"!=typeof s.name&&n({before:"div.title-pad","class":"error",message:s.name}))}function n(e){var i=e.before||!1,s=e.after||!1,t=e.message,n=e["class"]?"flash-"+e["class"]:"flash-success",a=!1,o=l("<div/>").addClass(n).html(t);i?(a=l(i),a.prev("."+n).remove(),o.insertBefore(a)):s&&(a=l(s),a.next("."+n).remove(),o.insertAfter(a))}function a(){v.views.menu=v.createView(u),v.views.navigationToggle=v.createView(c),v.views.langSwitch=v.createView(d),v.views.paginations=v.createViews(l(".pagination"),h)}function o(){e("jquery.livequery"),l("select").livequery(function(){l(this).toggleClass("empty",""===l(this).val()),l(this).change(function(){l(this).toggleClass("empty",""===l(this).val())})})}function r(){this.$body.hasClass("wasabi-core--languages-index")&&v.createView(e("core/sections/LanguagesIndex"))}var l=e("jquery"),u=(e("underscore"),e("core/views/Menu")),c=e("core/views/NavigationToggle"),d=e("core/views/LangSwitch"),h=e("core/views/Pagination"),v=e("wasabi"),w=window,g=document;return{options:{},w:null,d:null,$html:null,$body:null,views:[],collections:[],models:[],resizeTimeout:0,components:{},initialize:function(e){this.options=e||{},this.w=w,this.d=g,this.$html=l("html"),this.$body=l("body"),i.call(this),a.call(this),o.call(this),r.call(this)}}});