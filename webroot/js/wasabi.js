/**
 * gemini-scrollbar
 * @version 1.4.3
 * @link http://noeldelgado.github.io/gemini-scrollbar/
 * @license MIT
 */

/* Copyright (c) 2015 Lucas Wiener
   * https://github.com/wnr/element-resize-detector
   */

define("common/BaseViewFactory",["require","underscore"],function(e){var t=e("underscore"),i=function(e){this.eventBus=e,this.registry={factory:this}};return i.prototype=t.extend({},{register:function(e,t){return this.registry[e]=t,this.registry[e]},create:function(e,i){var s,o;return i=i||{},o=t.extend(i,this.registry,{eventBus:this.eventBus}),s=e,s.prototype.eventBus=this.eventBus,new s(o)}}),i}),define("wasabi",["require","jquery","underscore","backbone","./common/BaseViewFactory","bootstrap.dropdown"],function(e){var t=e("jquery"),i=e("underscore"),s=e("backbone"),o=e("./common/BaseViewFactory");e("bootstrap.dropdown");var n=i.extend({},s.Events),a=new o(n),l=0,r="undefined";if(typeof window.WS!==r)return window.WS;var c={features:{},modules:{registered:[]},initialized:!1,messages:{},views:[],eventBus:n,viewFactory:a,boot:function(){function i(t){var i=t.name,o=t.require,n=t.options;"undefined"==typeof s.modules[i]&&(s.modules[i]=i,e([o],function(e){s.modules[i]=e,s.modules[i].initialize(n)}))}for(var s=this,o=0,n=this.modules.registered.length;o<n;o++)i(this.modules.registered[o]);this.initialized||t(window).on("resize",function(){clearTimeout(l),l=setTimeout(function(){c.eventBus.trigger("window.resize")},100)})},registerModule:function(e,t){this.modules.registered.push({name:e,require:e,options:t||{}})},get:function(e){return this.modules[e]?this.modules[e]:void console.debug('module "'+e+" is not registered.")},createView:function(e,t){return this.viewFactory.create(e,t||{})},createViews:function(e,t,s){var o=[];return e.length>0&&e.each(function(e,n){o.push(c.createView(t,i.extend({el:n},s||{})))}),o},blockElement:function(e,i){i=t.extend({},{deltaWidth:0,deltaHeight:0,backgroundColor:"#fff",opacity:.6,cursor:"wait",zIndex:9997,whiteSpinner:!1},i);var s=t('<div class="block-backdrop"><div class="spinner"></div></div>'),o=e.offset(),n=e.css("borderLeftWidth"),a=e.css("borderTopWidth"),l=e.innerWidth()+i.deltaWidth,r=e.innerHeight()+i.deltaHeight;""!==n&&(n=parseInt(n.split("px")[0]),o.left+=n),""!==a&&(a=parseInt(a.split("px")[0]),o.top+=a),s.css({position:"absolute",top:0,left:0,width:l,height:r,backgroundColor:i.backgroundColor,opacity:i.opacity,cursor:i.cursor,zIndex:i.zIndex}).hide().appendTo(e),i.whiteSpinner&&s.find(".spinner").addClass("spinner-white"),s.fadeIn(100,function(){s.on("mousedown mouseup keydown keypress keyup touchstart touchend touchmove",this.handleBlockedEvent)})},unblockElement:function(e,t){t=t||function(){},this.spinner&&this.spinner.stop(),e.find(".block-backdrop").off("mousedown mouseup keydown keypress keyup touchstart touchend touchmove",this.handleBlockedEvent).remove(),"function"==typeof t&&t.call(this)},handleBlockedEvent:function(e){e.preventDefault(),e.stopPropagation()}};return window.WS=c,c}),define("core/views/Menu",["require","jquery","common/BaseView","tether","bootstrap.collapse"],function(e){var t=e("jquery"),i=e("common/BaseView"),s=e("tether");e("bootstrap.collapse");var o={collapsedClass:"collapsed",openClass:"open",selectedClass:"popout"},n=function(e,i){var s=t(e.target);return s.is("li")?s:(i=i||"",s.closest("li"+i))};return i.extend({el:".sidebar--menu",events:{"click > li:has(ul) > a":"onMainItemClick"},globalEvents:{"window.resize":"onWindowResize","sidebar.toggle-collapse":"onToggleCollapse"},isCollapsed:!1,isForceCollapsed:!1,options:{},$document:null,$scrollContainer:null,subnavTether:null,$subnavClone:null,initialize:function(e){this.options=t.extend({},o,e),this.$document=t(document),this.$scrollContainer=this.$el.closest(".gm-scrollbar-container"),this.collapseMenu()},onWindowResize:function(e){this.collapseMenu()},collapseMenu:function(){var e=window.getComputedStyle(document.querySelector(this.$el.selector),"::before").getPropertyValue("content").replace(/'/g,"").replace(/"/g,"");this.isCollapsed=this.isForceCollapsed||this.$document.find("body").hasClass("sidebar-is-collapsed")||"collapsed"===e,this.isCollapsed||null===this.subnavTether||(this.subnavTether.destroy(),this.$subnavClone.remove()),this.$scrollContainer.data("scrollbar")&&this.$scrollContainer.data("scrollbar").update()},onToggleCollapse:function(e){this.isForceCollapsed=e,this.isCollapsed=e,e||null===this.subnavTether||(this.subnavTether.destroy(),this.$subnavClone.remove()),this.$scrollContainer.data("scrollbar")&&this.$scrollContainer.data("scrollbar").update()},onMainItemClick:function(e){var i=n(e),o=i.find("> ul");if(0!==o.length){e.preventDefault(),e.stopPropagation();var a=this.$("."+this.options.selectedClass).filter(function(){return t(this)[0]!==i[0]});a.removeClass(this.options.selectedClass),this.isCollapsed&&!this.$document.find("body").hasClass("sidebar-is-open")?i.hasClass(this.options.selectedClass)?this.hideSubnav():(this.hideSubnav(),i.addClass(this.options.selectedClass),this.$subnavClone=o.clone().appendTo("body"),this.subnavTether=new s({element:this.$subnavClone,target:i,attachment:"top left",targetAttachment:"top right",constraints:[{to:this.$document.find("#content").get(0),pin:!0}]}),this.$document.on("click",_.bind(this.hideSubnav,this))):i.hasClass(this.options.openClass)?(i.removeClass(this.options.openClass),o.one("hidden.bs.collapse",_.bind(function(){setTimeout(_.bind(function(){this.$scrollContainer.data("scrollbar")&&this.$scrollContainer.data("scrollbar").update()},this),0)},this)),o.collapse("hide")):(i.addClass(this.options.openClass),o.one("shown.bs.collapse",_.bind(function(){setTimeout(_.bind(function(){this.$scrollContainer.data("scrollbar")&&this.$scrollContainer.data("scrollbar").update()},this),0)},this)),o.collapse("show"))}},hideSubnav:function(){this.$("."+this.options.selectedClass).removeClass(this.options.selectedClass),null!==this.subnavTether&&(this.subnavTether.destroy(),this.$subnavClone.remove(),this.$document.off("click",_.bind(this.hideSubnav,this)))}})}),define("core/views/SidebarOpenHandle",["require","jquery","common/BaseView","wasabi","js-cookie"],function(e){var t=e("jquery"),i=e("common/BaseView"),s=e("wasabi"),o=e("js-cookie"),n=t("body"),a={forceCollapsedClass:"sidebar-is-collapsed"};return i.extend({el:".sidebar--open-handle",events:{click:"collapseToggleNav"},options:{},initialize:function(e){this.options=t.extend({},a,e)},collapseToggleNav:function(){n.hasClass(this.options.forceCollapsedClass)?(n.removeClass(this.options.forceCollapsedClass),o.set("sidebar-collapsed",0,{expires:365}),s.eventBus.trigger("sidebar.toggle-collapse",!1)):(n.addClass(this.options.forceCollapsedClass),o.set("sidebar-collapsed",1,{expires:365}),s.eventBus.trigger("sidebar.toggle-collapse",!0))}})}),define("core/views/SidebarToggle",["require","underscore","jquery","common/BaseView"],function(e){var t=e("underscore"),i=e("jquery"),s=e("common/BaseView"),o=i("body"),n={forceOpenClass:"sidebar-is-open"};return s.extend({el:".sidebar--navigation-toggle",events:{click:"toggleNav"},options:{},initialize:function(e){this.options=i.extend({},n,e),this.$sidebar=i(".sidebar")},toggleNav:function(e){o.hasClass(this.options.forceOpenClass)?(o.removeClass(this.options.forceOpenClass),this.$sidebar.fadeOut(t.bind(function(){this.$sidebar.attr("style","")},this))):(o.addClass(this.options.forceOpenClass),this.$sidebar.fadeIn(),setTimeout(t.bind(function(){this.$sidebar.find(".gm-scrollbar-container").data("scrollbar").update()},this),0))}})}),define("core/views/LangSwitch",["require","underscore","common/BaseView"],function(e){var t=e("underscore"),i=e("common/BaseView");return i.extend({el:".lang-switch",globalEvents:{"wasabi-core--languages-sort":"updateLanguageLinkPositions"},updateLanguageLinkPositions:function(e,i){var s=i.frontendLanguages,o=[],n=this.$("li");t.each(s,function(e){o.push(n.filter('[data-language-id="'+e.id+'"]'))}),this.$el.html(o)}})}),define("core/views/Pagination",["require","jquery","common/BaseView","purl"],function(e){var t=e("jquery"),i=e("common/BaseView"),s=e("purl");return i.extend({el:".pagination",events:{"change .limit":"onChangeLimit"},onChangeLimit:function(e){var i=t(e.target),o=i.val(),n=i.attr("data-url"),a=s(window.location),l=i.attr("name").split("data[").join("").split("]").join(""),r=a.data.param.query;r[l]=o.toString();var c="",h=[];for(var d in r)r.hasOwnProperty(d)&&h.push(d+"="+r[d]);c=h.join("&"),""!==c&&(c="?"+c),window.location=n+c}})}),define("core/views/LoginModal",["require","underscore","jquery","common/BaseView","wasabi"],function(e){var t=e("underscore"),i=e("jquery"),s=e("common/BaseView"),o=e("wasabi");return s.extend({template:"",isOpen:!1,events:{"submit form":"onSubmit"},initialize:function(){this.template=t.template(i("#wasabi-core-login-modal").html()),this.$body=i("body")},openModal:function(){this.isOpen||(this.isOpen=!0,this.$body.addClass("modal-open"),this.$modal=i(this.template()),this.setElement(this.$modal),this.$button=this.$("button"),this.$modal.appendTo(this.$body),this.$("#email").focus())},onSubmit:function(e){e.preventDefault();var s=this.$("form");this.$button.prepend('<span class="spinner spinner-white"></span>').attr("disabled","disabled"),i.ajax({url:s.attr("action"),data:s.serialize(),method:"post",success:t.bind(function(e){e.content?(this.$(".modal-body").html(e.content),this.$("#email").focus(),this.$button.find(".spinner").remove(),this.$button.attr("disabled","").prop("disabled",!1)):e.redirect||(this.closeModal(),o.get("wasabi.core").initHeartBeat())},this)})},closeModal:function(){i.when.apply(null,[this.$(".modal-container").fadeOut(200),this.$(".modal-backdrop").fadeOut(200)]).then(i.proxy(function(){this.$modal&&this.$modal.remove(),this.$body.removeClass("modal-open"),this.isOpen=!1},this))}})}),define("common/ModalView",["require","jquery","underscore","common/BaseView","wasabi"],function(e){var t=e("jquery"),i=e("underscore"),s=e("common/BaseView"),o=e("wasabi"),n=t("body"),a=t(document),l=t(window),r={width:400,offsetTop:200,opacity:.35,padding:20,cssClasses:{backdrop:"modal-backdrop",scrollable:"modal-scrollable",container:"modal-container",modalHeader:"modal-header",modalBody:"modal-body",modalFooter:"modal-footer",confirmFooter:"modal-confirm"},confirmYes:"Yes",confirmNo:"No",closeOnScrollable:!0,closeOnSubmit:!0};return s.extend({template:"",$backdrop:null,$container:null,$closeButtons:null,$modal:null,$notify:null,$scrollable:null,$submitButtons:null,events:{click:"openModal"},globalEvents:{"window.resize":"onResize"},modalName:null,isConfirmModal:!1,isOpened:!1,method:null,modalSuccessEvent:null,options:{},initialize:function(e){this.options=t.extend({},r,e),this.template=i.template(t("#wasabi-core-modal").html())},initModalOptions:function(){if(this.method=this.$el.attr("data-modal-method")||"post",this.isAjax="1"===this.$el.attr("data-modal-ajax")||"true"===this.$el.attr("data-modal-ajax"),this.action=this.$el.attr("data-modal-action")||this.$el.attr("href")||!1,this.isAjax){var e=this.$el.attr("data-modal-notify");this.$notify=void 0!==e?t(e):a,this.modalSuccessEvent=this.$el.attr("data-modal-event")||"modal:success"}var i=parseInt(this.$el.attr("data-modal-width"));i&&(this.options.width=i),"undefined"!=typeof this.$el.attr("data-modal-close-on-scrollable")&&(this.options.closeOnScrollable=parseInt(this.$el.attr("data-modal-close-on-scrollable"))),"undefined"!=typeof this.$el.attr("data-modal-close-on-submit")&&(this.options.closeOnSubmit=parseInt(this.$el.attr("data-modal-close-on-submit"))),this.options.forceCloseModalLink=parseInt(this.$el.attr("data-force-close-modal-link"))},createTemplateOptions:function(){var e,i,s={};return s.modalHeader=this.$el.attr("data-modal-header")||this.options.modalHeader,s.hasHeader=void 0!==s.modalHeader,s.modalBody=this.$el.attr("data-modal-body")||this.options.modalBody,s.hasBody=void 0!==s.modalBody,s.hasBody||(i=t(this.$el.attr("data-modal-target")),e=i.length>0,e&&(s.modalBody=i.html(),s.hasBody=!0)),s.isConfirmModal="confirm"===this.$el.attr("data-toggle"),s.isConfirmModal?s.hasFooter=!0:(s.modalFooter=this.$el.attr("data-modal-footer"),s.hasFooter=void 0!==s.modalFooter),s.action=this.action,s.method=this.method,s.cssClasses=this.options.cssClasses,s.confirmYes=this.options.confirmYes,s.confirmNo=this.options.confirmNo,s.forceCloseModalLink=this.options.forceCloseModalLink,s.hasCloseLink=!s.isConfirmModal||s.forceCloseModalLink,s},initModalElements:function(){this.$modal=t(this.template(this.createTemplateOptions())),this.$backdrop=this.$modal.find("."+this.options.cssClasses.backdrop),this.$backdrop.css({opacity:this.options.opacity}),this.$scrollable=this.$modal.find("."+this.options.cssClasses.scrollable),this.$container=this.$modal.find("."+this.options.cssClasses.container),this.$container.css({width:this.options.width,position:"fixed",left:-99999,top:this.options.offsetTop,opacity:0,zIndex:1e4}),this.$closeButtons=this.$modal.find('[data-dismiss="modal"]'),this.$submitButtons=this.$modal.find('button[type="submit"]')},updatePosition:function(){var e=this.$container.outerHeight(),t=this.$container.offset().top-this.$scrollable.offset().top,i=this.$scrollable.height(),s=i-e-t<this.options.offsetTop;l.height()<a.height()?n.addClass("page-overflow").addClass("fix-scroll-"+this.options.scrollbarWidth):n.removeClass("page-overflow").removeClass("fix-scroll-"+this.options.scrollbarWidth),s?e+2*this.options.padding<=i?this.$container.css({top:"50%",marginTop:-e/2}):this.$container.css({top:this.options.padding,marginTop:0}):this.$container.css({top:this.options.offsetTop,marginTop:0}),this.$container.css({position:"absolute",marginLeft:-this.options.width/2,left:"50%"})},resetDOM:function(){n.removeClass("modal-open").removeClass("page-overflow"),this.$modal=null,this.$container=null,this.$scrollable=null,this.$backdrop=null,this.$submitButtons=[]},onResize:function(){this.isOpened&&this.updatePosition()},submit:function(e){var i=t(e.target),s=this;if(void 0===i.attr("disabled"))if(this.isAjax){e.preventDefault(),i.prop("disabled",!0),this.$notify.trigger("modal:beforeAjax");var n,a=this.$modal.find("form");a.length>0&&(n=this.$modal.find("form").serialize()),t.ajax({type:this.method,url:this.action,cache:!1,data:n,success:function(e){s.closeModal(),s.$notify.trigger(s.modalSuccessEvent,e)}})}else this.modalName&&o.eventBus.trigger("modal-submitted-"+this.modalName,this,e),this.options.closeOnSubmit&&this.closeModal()},openModal:function(e){if(e&&e.preventDefault(),!this.isOpened&&!this.$el.hasClass("disabled")){if(this.isOpened=!0,this.initModalOptions(),this.initModalElements(),n.addClass("modal-open"),this.$modal.appendTo(n),this.updatePosition(),this.$container.hide().css("opacity",1).fadeIn(),this.$closeButtons.length>1)for(var s=0,a=this.$closeButtons.length;s<a;s++)t(this.$closeButtons[s]).on("click",i.bind(this.closeModal,this));else this.$closeButtons.on("click",i.bind(this.closeModal,this));this.options.closeOnScrollable&&this.$scrollable.on("click",i.bind(this.closeModal,this)),this.$submitButtons.length&&this.$submitButtons.on("click",i.bind(this.submit,this)),this.modalName=this.$el.attr("data-modal-name"),this.modalName&&(this.$modal.attr("data-modal-name",this.modalName),o.eventBus.trigger("modal-opened-"+this.modalName,this))}},closeModal:function(e){if("object"==typeof e){if(e.target!==e.currentTarget&&t(e.target).parent()[0]!==e.currentTarget)return;e.preventDefault()}if(this.$closeButtons.length>1)for(var s=0,o=this.$closeButtons.length;s<o;s++)t(this.$closeButtons[s]).off("click",i.bind(this.closeModal,this));else this.$closeButtons.off("click",i.bind(this.closeModal,this));this.options.closeOnScrollable&&this.$scrollable.off("click",i.bind(this.closeModal,this)),this.$submitButtons.length&&this.$submitButtons.off("click",i.bind(this.submit,this)),this.unblockThis(),t.when.apply(null,[this.$container.fadeOut(200),this.$backdrop.fadeOut(200)]).then(t.proxy(function(){this.$modal&&this.$modal.remove(),this.resetDOM(),this.isOpened=!1,"function"==typeof e&&e.call()},this))}})}),define("common/TabView",["require","jquery","common/BaseView"],function(e){var t=e("jquery"),i=e("common/BaseView");return i.extend({events:{"click li":"onClick","click a":"onClick"},initialize:function(){this.tabifyId=this.$el.attr("data-tabify-id"),this.$listItems=this.$("> li"),this.$tabs=t("div[data-tabify-tab]").filter('[data-tabify-id="'+this.tabifyId+'"]');var e=window.location.hash.split("#")[1]||null,i=this.$listItems.filter('[data-tabify-target="'+e+'"]:not([data-tabify-disabled="1"])'),s=this.$listItems.filter(".active").length>0;s||(i.length>0?i.find("a").trigger("click"):this.$listItems.first().addClass("active"))},onClick:function(e){e.preventDefault(),e.stopPropagation();var i=t(e.target);if(i.is("a")&&(i=i.parent()),!i.is("li"))return!1;var s=i.attr("data-tabify-target"),o=i.attr("data-tabify-disabled"),n=i.hasClass("active");return("undefined"==typeof o||"1"!==o)&&n!==!0&&(this.$listItems.removeClass("active"),this.$tabs.removeClass("active").hide(),this.$tabs.filter('[data-tabify-tab="'+s+'"]').addClass("active").show(),window.history.replaceState(null,null,"#"+s),t("body").trigger("tab-changed."+s),void i.addClass("active"))}})}),function(){function e(){var e,t=document.createElement("div");return t.style.position="absolute",t.style.top="-9999px",t.style.width="100px",t.style.height="100px",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",document.body.appendChild(t),e=t.offsetWidth-t.clientWidth,document.body.removeChild(t),e}function t(e,t){return e.classList?t.forEach(function(t){e.classList.add(t)}):void(e.className+=" "+t.join(" "))}function i(e,t){return e.classList?t.forEach(function(t){e.classList.remove(t)}):void(e.className=e.className.replace(new RegExp("(^|\\b)"+t.join("|")+"(\\b|$)","gi")," "))}function s(){var e=navigator.userAgent.toLowerCase();return e.indexOf("msie")!==-1||e.indexOf("trident")!==-1||e.indexOf(" edge/")!==-1}function o(t){this.element=null,this.autoshow=!1,this.createElements=!0,this.forceGemini=!1,this.onResize=null,Object.keys(t||{}).forEach(function(e){this[e]=t[e]},this),n=e(),a=0===n&&this.forceGemini===!1,this._cache={events:{}},this._created=!1,this._cursorDown=!1,this._prevPageX=0,this._prevPageY=0,this._document=null,this._viewElement=this.element,this._scrollbarVerticalElement=null,this._thumbVerticalElement=null,this._scrollbarHorizontalElement=null,this._scrollbarHorizontalElement=null}var n,a,l;l={element:"gm-scrollbar-container",verticalScrollbar:"gm-scrollbar -vertical",horizontalScrollbar:"gm-scrollbar -horizontal",thumb:"thumb",view:"gm-scroll-view",autoshow:"gm-autoshow",disable:"gm-scrollbar-disable-selection",prevented:"gm-prevented",resizeTrigger:"gm-resize-trigger"},o.prototype.create=function(){if(a){if(t(this.element,[l.prevented]),this.onResize){if(this.createElements===!0){for(this._viewElement=document.createElement("div");this.element.childNodes.length>0;)this._viewElement.appendChild(this.element.childNodes[0]);this.element.appendChild(this._viewElement)}else this._viewElement=this.element.querySelector("."+l.view);t(this.element,[l.element]),t(this._viewElement,[l.view]),this._createResizeTrigger()}return this}if(this._created===!0)return console.warn("calling on a already-created object"),this;if(this.autoshow&&t(this.element,[l.autoshow]),this._document=document,this.createElements===!0){for(this._viewElement=document.createElement("div"),this._scrollbarVerticalElement=document.createElement("div"),this._thumbVerticalElement=document.createElement("div"),this._scrollbarHorizontalElement=document.createElement("div"),this._thumbHorizontalElement=document.createElement("div");this.element.childNodes.length>0;)this._viewElement.appendChild(this.element.childNodes[0]);this._scrollbarVerticalElement.appendChild(this._thumbVerticalElement),this._scrollbarHorizontalElement.appendChild(this._thumbHorizontalElement),this.element.appendChild(this._scrollbarVerticalElement),this.element.appendChild(this._scrollbarHorizontalElement),this.element.appendChild(this._viewElement)}else this._viewElement=this.element.querySelector("."+l.view),this._scrollbarVerticalElement=this.element.querySelector("."+l.verticalScrollbar.split(" ").join(".")),this._thumbVerticalElement=this._scrollbarVerticalElement.querySelector("."+l.thumb),this._scrollbarHorizontalElement=this.element.querySelector("."+l.horizontalScrollbar.split(" ").join(".")),this._thumbHorizontalElement=this._scrollbarHorizontalElement.querySelector("."+l.thumb);return t(this.element,[l.element]),t(this._viewElement,[l.view]),t(this._scrollbarVerticalElement,l.verticalScrollbar.split(/\s/)),t(this._scrollbarHorizontalElement,l.horizontalScrollbar.split(/\s/)),t(this._thumbVerticalElement,[l.thumb]),t(this._thumbHorizontalElement,[l.thumb]),this._scrollbarVerticalElement.style.display="",this._scrollbarHorizontalElement.style.display="",this._createResizeTrigger(),this._created=!0,this._bindEvents().update()},o.prototype._createResizeTrigger=function(){var e=document.createElement("object");t(e,[l.resizeTrigger]),e.type="text/html";var i=this._resizeHandler.bind(this);e.onload=function(){var t=e.contentDocument.defaultView;t.addEventListener("resize",i)},s()||(e.data="about:blank"),this.element.appendChild(e),s()&&(e.data="about:blank"),this._resizeTriggerElement=e},o.prototype.update=function(){if(a)return this;if(this._created===!1)return console.warn("calling on a not-yet-created object"),this;var e,t;return this._viewElement.style.width=(this.element.offsetWidth+n).toString()+"px",this._viewElement.style.height=(this.element.offsetHeight+n).toString()+"px",e=100*this._viewElement.clientHeight/this._viewElement.scrollHeight,t=100*this._viewElement.clientWidth/this._viewElement.scrollWidth,this._thumbVerticalElement.style.height=e<100?e+"%":"",this._thumbHorizontalElement.style.width=t<100?t+"%":"",this._scrollHandler(),this},o.prototype.destroy=function(){if(this._resizeTriggerElement&&(this.element.removeChild(this._resizeTriggerElement),this._resizeTriggerElement=null),a)return this;if(this._created===!1)return console.warn("calling on a not-yet-created object"),this;if(this._unbinEvents(),i(this.element,[l.element,l.autoshow]),this.createElements===!0){for(this.element.removeChild(this._scrollbarVerticalElement),this.element.removeChild(this._scrollbarHorizontalElement);this._viewElement.childNodes.length>0;)this.element.appendChild(this._viewElement.childNodes[0]);this.element.removeChild(this._viewElement)}else this._viewElement.style.width="",this._viewElement.style.height="",this._scrollbarVerticalElement.style.display="none",this._scrollbarHorizontalElement.style.display="none";return this._created=!1,this._document=null,null},o.prototype.getViewElement=function(){return this._viewElement},o.prototype._bindEvents=function(){return this._cache.events.scrollHandler=this._scrollHandler.bind(this),this._cache.events.clickVerticalTrackHandler=this._clickVerticalTrackHandler.bind(this),this._cache.events.clickHorizontalTrackHandler=this._clickHorizontalTrackHandler.bind(this),this._cache.events.clickVerticalThumbHandler=this._clickVerticalThumbHandler.bind(this),this._cache.events.clickHorizontalThumbHandler=this._clickHorizontalThumbHandler.bind(this),this._cache.events.mouseUpDocumentHandler=this._mouseUpDocumentHandler.bind(this),this._cache.events.mouseMoveDocumentHandler=this._mouseMoveDocumentHandler.bind(this),this._viewElement.addEventListener("scroll",this._cache.events.scrollHandler),this._scrollbarVerticalElement.addEventListener("mousedown",this._cache.events.clickVerticalTrackHandler),this._scrollbarHorizontalElement.addEventListener("mousedown",this._cache.events.clickHorizontalTrackHandler),this._thumbVerticalElement.addEventListener("mousedown",this._cache.events.clickVerticalThumbHandler),this._thumbHorizontalElement.addEventListener("mousedown",this._cache.events.clickHorizontalThumbHandler),this._document.addEventListener("mouseup",this._cache.events.mouseUpDocumentHandler),this},o.prototype._unbinEvents=function(){return this._viewElement.removeEventListener("scroll",this._cache.events.scrollHandler),this._scrollbarVerticalElement.removeEventListener("mousedown",this._cache.events.clickVerticalTrackHandler),this._scrollbarHorizontalElement.removeEventListener("mousedown",this._cache.events.clickHorizontalTrackHandler),this._thumbVerticalElement.removeEventListener("mousedown",this._cache.events.clickVerticalThumbHandler),this._thumbHorizontalElement.removeEventListener("mousedown",this._cache.events.clickHorizontalThumbHandler),this._document.removeEventListener("mouseup",this._cache.events.mouseUpDocumentHandler),this._document.removeEventListener("mousemove",this._cache.events.mouseMoveDocumentHandler),this},o.prototype._scrollHandler=function(){var e,t,i;e=this._viewElement,i=100*e.scrollTop/e.clientHeight,t=100*e.scrollLeft/e.clientWidth,this._thumbVerticalElement.style.msTransform="translateY("+i+"%)",this._thumbVerticalElement.style.webkitTransform="translateY("+i+"%)",this._thumbVerticalElement.style.transform="translateY("+i+"%)",this._thumbHorizontalElement.style.msTransform="translateX("+t+"%)",this._thumbHorizontalElement.style.webkitTransform="translateX("+t+"%)",this._thumbHorizontalElement.style.transform="translateX("+t+"%)"},o.prototype._resizeHandler=function(){this.update(),this.onResize&&this.onResize()},o.prototype._clickVerticalTrackHandler=function(e){var t=Math.abs(e.target.getBoundingClientRect().top-e.clientY),i=this._thumbVerticalElement.offsetHeight/2,s=100*(t-i)/this._scrollbarVerticalElement.offsetHeight;this._viewElement.scrollTop=s*this._viewElement.scrollHeight/100},o.prototype._clickHorizontalTrackHandler=function(e){var t=Math.abs(e.target.getBoundingClientRect().left-e.clientX),i=this._thumbHorizontalElement.offsetWidth/2,s=100*(t-i)/this._scrollbarHorizontalElement.offsetWidth;this._viewElement.scrollLeft=s*this._viewElement.scrollWidth/100},o.prototype._clickVerticalThumbHandler=function(e){this._startDrag(e),this._prevPageY=e.currentTarget.offsetHeight-(e.clientY-e.currentTarget.getBoundingClientRect().top)},o.prototype._clickHorizontalThumbHandler=function(e){this._startDrag(e),this._prevPageX=e.currentTarget.offsetWidth-(e.clientX-e.currentTarget.getBoundingClientRect().left)},o.prototype._startDrag=function(e){e.stopImmediatePropagation(),this._cursorDown=!0,t(document.body,[l.disable]),this._document.addEventListener("mousemove",this._cache.events.mouseMoveDocumentHandler),this._document.onselectstart=function(){return!1}},o.prototype._mouseUpDocumentHandler=function(){this._cursorDown=!1,this._prevPageX=this._prevPageY=0,i(document.body,[l.disable]),this._document.removeEventListener("mousemove",this._cache.events.mouseMoveDocumentHandler),this._document.onselectstart=null},o.prototype._mouseMoveDocumentHandler=function(e){if(this._cursorDown!==!1){var t,i,s;return this._prevPageY?(t=(this._scrollbarVerticalElement.getBoundingClientRect().top-e.clientY)*-1,i=this._thumbVerticalElement.offsetHeight-this._prevPageY,s=100*(t-i)/this._scrollbarVerticalElement.offsetHeight,void(this._viewElement.scrollTop=s*this._viewElement.scrollHeight/100)):void(this._prevPageX&&(t=(this._scrollbarHorizontalElement.getBoundingClientRect().left-e.clientX)*-1,i=this._thumbHorizontalElement.offsetWidth-this._prevPageX,s=100*(t-i)/this._scrollbarHorizontalElement.offsetWidth,this._viewElement.scrollLeft=s*this._viewElement.scrollWidth/100))}},"object"==typeof exports?module.exports=o:window.GeminiScrollbar=o}(),define("geminiscrollbar",function(){}),define("core/views/LanguagesTable",["require","jquery","common/BaseView","wasabi","jquery.tSortable"],function(e){var t=e("jquery"),i=e("common/BaseView"),s=e("wasabi");return e("jquery.tSortable"),i.extend({events:{"tSortable-change":"onSort"},initialize:function(e){this.$form=this.$el.closest("form"),this.$el.tSortable({handle:"a.action-sort",placeholder:"sortable-placeholder",opacity:.8})},onSort:function(e){var i=t(e.target);i.find("tbody > tr").each(function(e){t(this).find("input.position").first().val(e)}),t.ajax({url:this.$form.attr("action"),data:this.$form.serialize(),type:"post",success:function(t){s.eventBus.trigger("wasabi-core--languages-sort",e,t)}})}})}),define("core/sections/LanguagesIndex",["require","common/BaseView","wasabi","../views/LanguagesTable"],function(e){var t=e("common/BaseView"),i=e("wasabi"),s=e("../views/LanguagesTable");return t.extend({el:".wasabi-core--languages-index",initialize:function(e){i.createView(s,{el:this.$("table.languages")})}})}),define("core/sections/GroupPermissionsIndex",["require","jquery","common/BaseView","jquery.color"],function(e){var t=e("jquery"),i=e("common/BaseView");return e("jquery.color"),i.extend({el:".wasabi-core--grouppermissions-index",events:{"click .single-submit":"onSingleSubmit"},onSingleSubmit:function(e){e.preventDefault();var i=t(e.target),s=t('<div class="spinner"/>');i.hide().blur().parent().append(s),t.ajax({type:"post",url:this.$(".permissions-update-form").attr("action"),data:i.parent().parent().find("input").serialize(),dataType:"json",cache:!1,success:function(){var e=i.parent().parent(),o=i.parent().css("backgroundColor");s.remove(),i.show(),e.find("td:not(.controller)").stop().css({backgroundColor:"#fff7d9"}).animate({backgroundColor:o},1e3,function(){t(this).css({backgroundColor:""})})}})}})}),define("wasabi.core",["require","jquery","underscore","core/views/Menu","core/views/SidebarOpenHandle","core/views/SidebarToggle","core/views/LangSwitch","core/views/Pagination","core/views/LoginModal","common/ModalView","common/TabView","wasabi","pace","geminiscrollbar","jquery.livequery","core/sections/LanguagesIndex","core/sections/GroupPermissionsIndex"],function(e){function t(){b.ajaxSetup({dataType:"json",beforeSend:v.bind(function(e,t){t.heartBeat||f.call(this)},this)}),b(V).ajaxSuccess(v.bind(i,this)).ajaxError(v.bind(s,this))}function i(e,t){if(200==t.status&&"OK"==t.statusText){var i=t.getResponseHeader("Content-Type");if(2===i.split("application/json").length){var s=b.parseJSON(t.responseText)||{};"undefined"!=typeof s.status&&("undefined"!=typeof s.flash&&n(s.flash),"undefined"!=typeof s.redirect&&(z.location=s.redirect))}}}function s(e,t){var i;401==t.status&&(i=b.parseJSON(t.responseText)||{},"undefined"!=typeof i.name&&(confirm(i.name)?z.location.reload():z.location.reload())),403==t.status&&p.call(this),500==t.status&&(i=b.parseJSON(t.responseText)||{},"undefined"!=typeof i.name&&n({before:"div.title-pad",class:"error",message:i.name}))}function o(){function e(){var e=b("<div/>").css({width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),t=b("body");e.prependTo(t);var i=0;return setTimeout(function(){i=e[0].offsetWidth-e[0].clientWidth},0),e.remove(),i}k.features.scrollbarWidth=e()}function n(e){var t=e.before||!1,i=e.after||!1,s=e.message,o=e.class?"flash-"+e.class:"flash-success",n=!1,a=b("<div/>").addClass(o).html(s);t?(n=b(t),n.prev("."+o).remove(),a.insertBefore(n)):i&&(n=b(i),n.next("."+o).remove(),a.insertAfter(n))}function a(){k.views.menu=k.createView(g),k.views.navigationToggle=k.createView(y),k.views.sidebarOpenHandle=k.createView(w),k.views.langSwitch=k.createView(_),k.views.paginations=k.createViews(b(".pagination"),$)}function l(){b("select").livequery(function(){b(this).toggleClass("empty",""===b(this).val()),b(this).change(function(){b(this).toggleClass("empty",""===b(this).val())})})}function r(){var e=this;k.views.modals=[],b('[data-toggle="modal"], [data-toggle="confirm"]').livequery(function(){k.views.modals.push(k.createView(C,{el:b(this),scrollbarWidth:k.features.scrollbarWidth,confirmYes:e.options.translations.confirmYes,confirmNo:e.options.translations.confirmNo}))})}function c(){b(".tabs[data-tabify-id]").livequery(function(){k.views.push(k.createView(H,{el:b(this)}))})}function h(){this.$body.find('[data-init="gm-scrollbar"]').each(function(){b(this).css("overflow","auto");var e=new window.GeminiScrollbar({element:b(this).get(0),autoshow:!1,createElements:!1,forceGemini:!1});e.create(),b(this).data("scrollbar",e)})}function d(){
this.$body.on("click",".dropdown-interaction",function(e){e.stopPropagation()})}function u(){this.$body.hasClass("wasabi-core--languages-index")&&k.createView(e("core/sections/LanguagesIndex")),this.$body.hasClass("wasabi-core--grouppermissions-index")&&k.createView(e("core/sections/GroupPermissionsIndex"))}function m(e){401===e.status?p.call(this):f.call(this)}function p(){clearTimeout(this.heartBeatTimeout),this.loginModal.openModal()}function f(){this.loginModal||(this.loginModal=k.createView(E,{})),clearTimeout(this.heartBeatTimeout),this.heartBeatTimeout=setTimeout(v.bind(function(){b.ajax({url:this.options.heartbeatEndpoint,method:"post",type:"json",success:v.bind(m,this),error:v.bind(p,this),heartBeat:!0})},this),this.options.heartbeat)}var b=e("jquery"),v=e("underscore"),g=e("core/views/Menu"),w=e("core/views/SidebarOpenHandle"),y=e("core/views/SidebarToggle"),_=e("core/views/LangSwitch"),$=e("core/views/Pagination"),E=e("core/views/LoginModal"),C=e("common/ModalView"),H=e("common/TabView"),k=e("wasabi"),T=e("pace");e("geminiscrollbar"),e("jquery.livequery");var z=window,V=document;return{options:{},w:null,d:null,$html:null,$body:null,views:[],collections:[],models:[],heartBeatTimeout:0,resizeTimeout:0,components:{},loginModal:null,initialize:function(e){this.options=e||{},this.w=z,this.d=V,this.$html=b("html"),this.$body=b("body"),T.start(),t.call(this),o.call(this),h.call(this),a.call(this),l.call(this),r.call(this),c.call(this),u.call(this),d.call(this),f.call(this)},initHeartBeat:function(){f.call(this)}}});