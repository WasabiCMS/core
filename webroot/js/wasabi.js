/*!
 * jQuery Color Animations v@VERSION
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: @DATE
 */

define("common/BaseViewFactory",["require","underscore"],function(e){var t=e("underscore"),n=function(e){this.eventBus=e,this.registry={factory:this}};return n.prototype=t.extend({},{register:function(e,t){return this.registry[e]=t,this.registry[e]},create:function(e,n){var i,s;return n=n||{},s=t.extend(n,this.registry,{eventBus:this.eventBus}),i=e,i.prototype.eventBus=this.eventBus,new i(s)}}),n}),define("wasabi",["require","jquery","underscore","backbone","./common/BaseViewFactory","bootstrap.dropdown"],function(e){var t=e("jquery"),n=e("underscore"),i=e("backbone"),s=e("./common/BaseViewFactory");e("bootstrap.dropdown");var r=n.extend({},i.Events),o=new s(r),a=0,l="undefined";if(typeof window.WS!==l)return window.WS;var u={features:{},modules:{registered:[]},views:[],eventBus:r,viewFactory:o,boot:function(){function i(t){var n=t.name,i=t.require,r=t.options;e([i],function(e){s.modules[n]=e,s.modules[n].initialize(r)})}for(var s=this,r=0,o=this.modules.registered.length;o>r;r++)i(this.modules.registered[r]);t(window).on("resize",function(){clearTimeout(a),a=setTimeout(n.bind(function(){this.eventBus.trigger("window.resize")},this),100)})},registerModule:function(e,t){this.modules.registered.push({name:e,require:e,options:t||{}})},get:function(e){return this.modules[e]?this.modules[e]:void console.debug('module "'+e+" is not registered.")},createView:function(e,t){return this.viewFactory.create(e,t||{})},createViews:function(e,t,i){var s=[];return e.length>0&&e.each(function(e,r){s.push(u.createView(t,n.extend({el:r},i||{})))}),s}};return window.WS=u,u}),define("core/views/Menu",["require","jquery","wasabi.BaseView","wasabi"],function(e){var t=e("jquery"),n=e("wasabi.BaseView"),i=(e("wasabi"),{collapsedClass:"collapsed",openClass:"open",popoutClass:"popout"}),s=function(e,n){var i=t(e.target);return i.is("li")?i:(n=n||"",i.closest("li"+n))};return n.extend({el:"#backend-menu > ul",events:function(){var e={"click > li:has(ul) > a":"onMainItemClick"};return this.isCollapsed&&(e=t.extend(e,{"mouseenter > li":"onMainItemMouseenter","mouseleave > li":"onMainItemMouseleave"})),e},globalEvents:{"window.resize":"collapseMenu"},isCollapsed:!1,options:{},initialize:function(e){this.options=t.extend({},i,e),this.$("> li").filter(".active").prev().addClass("prev-active"),this.collapseMenu()},collapseMenu:function(){var e=this.isCollapsed;this.isCollapsed="none"===this.$("> li > a > .item-name").first().css("display"),this.isCollapsed?(this.$el.addClass(this.options.collapsedClass),this.isCollapsed!==e&&this.delegateEvents(this.events())):(this.$el.removeClass(this.options.collapsedClass),this.delegateEvents(this.events()))},onMainItemClick:function(e){s(e).toggleClass(this.options.openClass)},onMainItemMouseenter:function(e){this.isCollapsed&&s(e).addClass(this.options.popoutClass)},onMainItemMouseleave:function(e){this.isCollapsed&&s(e,"."+this.options.popoutClass).removeClass(this.options.popoutClass)},onResize:function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(_.bind(this.collapseMenu,this),100)}})}),define("core/views/NavigationToggle",["require","jquery","wasabi.BaseView"],function(e){var t=e("jquery"),n=e("wasabi.BaseView"),i=t("body"),s={navClosedClass:"nav-closed"};return n.extend({el:"body > header .toggle-nav",events:{click:"toggleNav"},isClosed:!1,options:{},initialize:function(e){this.options=t.extend({},s,e),this.isClosed=i.hasClass(this.options.navClosedClass)},toggleNav:function(){this.closed?(i.removeClass(this.options.navClosedClass),this.closed=!1):(i.addClass(this.options.navClosedClass),this.closed=!0)}})}),define("core/views/LangSwitch",["require","underscore","wasabi.BaseView"],function(e){var t=e("underscore"),n=e("wasabi.BaseView");return n.extend({el:".lang-switch",globalEvents:{"wasabi-core--languages-sort":"updateLanguageLinkPositions"},updateLanguageLinkPositions:function(e,n){var i=n.frontendLanguages,s=[],r=this.$("li");t.each(i,function(e){s.push(r.filter('[data-language-id="'+e.id+'"]'))}),this.$el.html(s)}})}),define("core/views/Pagination",["require","jquery","wasabi.BaseView","purl"],function(e){var t=e("jquery"),n=e("wasabi.BaseView"),i=e("purl");return n.extend({el:".pagination",events:{"change .limit":"onChangeLimit"},onChangeLimit:function(e){var n=t(e.target),s=n.val(),r=n.attr("data-url"),o=i(window.location),a=n.attr("name").split("data[").join("").split("]").join(""),l=o.data.param.query;l[a]=s.toString();var u="",c=[];for(var d in l)l.hasOwnProperty(d)&&c.push(d+"="+l[d]);u=c.join("&"),""!==u&&(u="?"+u),window.location=r+u}})}),define("core/views/LanguagesTable",["require","jquery","wasabi.BaseView","wasabi","jquery.tSortable"],function(e){var t=e("jquery"),n=e("wasabi.BaseView"),i=e("wasabi");return e("jquery.tSortable"),n.extend({events:{"tSortable-change":"onSort"},initialize:function(){this.$form=this.$el.closest("form"),this.$el.tSortable({handle:"a.action-sort",placeholder:"sortable-placeholder",opacity:.8})},onSort:function(e){var n=t(e.target);n.find("tbody > tr").each(function(e){t(this).find("input.position").first().val(e)}),t.ajax({url:this.$form.attr("action"),data:this.$form.serialize(),type:"post",success:function(t){i.eventBus.trigger("wasabi-core--languages-sort",e,t)}})}})}),define("core/sections/LanguagesIndex",["require","wasabi.BaseView","wasabi","../views/LanguagesTable"],function(e){var t=e("wasabi.BaseView"),n=e("wasabi"),i=e("../views/LanguagesTable");return t.extend({el:".wasabi-core--languages-index",initialize:function(){n.createView(i,{el:this.$("table.languages")})}})}),define("common/SpinPresets",["require"],function(){return{small:{lines:12,length:0,width:3,radius:6},medium:{lines:9,length:4,width:2,radius:3},large:{lines:11,length:7,width:2,radius:5},mega:{lines:11,length:10,width:3,radius:8}}}),function(e,t){function n(e,t,n){var i=d[t.type]||{};return null==e?n||!t.def?null:t.def:(e=i.floor?~~e:parseFloat(e),isNaN(e)?t.def:i.mod?(e+i.mod)%i.mod:0>e?0:i.max<e?i.max:e)}function i(t){var n=u(),i=n._rgba=[];return t=t.toLowerCase(),h(l,function(e,s){var r,o=s.re.exec(t),a=o&&s.parse(o),l=s.space||"rgba";return a?(r=n[l](a),n[c[l].cache]=r[c[l].cache],i=n._rgba=r._rgba,!1):void 0}),i.length?("0,0,0,0"===i.join()&&e.extend(i,r.transparent),n):r[t]}function s(e,t,n){return n=(n+1)%1,1>6*n?e+(t-e)*n*6:1>2*n?t:2>3*n?e+(t-e)*(2/3-n)*6:e}var r,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",a=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],u=e.Color=function(t,n,i,s){return new e.Color.fn.parse(t,n,i,s)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},d={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},f=u.support={},p=e("<p>")[0],h=e.each;p.style.cssText="background-color:rgba(1,1,1,.5)",f.rgba=p.style.backgroundColor.indexOf("rgba")>-1,h(c,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),u.fn=e.extend(u.prototype,{parse:function(s,o,a,l){if(s===t)return this._rgba=[null,null,null,null],this;(s.jquery||s.nodeType)&&(s=e(s).css(o),o=t);var d=this,f=e.type(s),p=this._rgba=[];return o!==t&&(s=[s,o,a,l],f="array"),"string"===f?this.parse(i(s)||r._default):"array"===f?(h(c.rgba.props,function(e,t){p[t.idx]=n(s[t.idx],t)}),this):"object"===f?(s instanceof u?h(c,function(e,t){s[t.cache]&&(d[t.cache]=s[t.cache].slice())}):h(c,function(t,i){var r=i.cache;h(i.props,function(e,t){if(!d[r]&&i.to){if("alpha"===e||null==s[e])return;d[r]=i.to(d._rgba)}d[r][t.idx]=n(s[e],t,!0)}),d[r]&&e.inArray(null,d[r].slice(0,3))<0&&(d[r][3]=1,i.from&&(d._rgba=i.from(d[r])))}),this):void 0},is:function(e){var t=u(e),n=!0,i=this;return h(c,function(e,s){var r,o=t[s.cache];return o&&(r=i[s.cache]||s.to&&s.to(i._rgba)||[],h(s.props,function(e,t){return null!=o[t.idx]?n=o[t.idx]===r[t.idx]:void 0})),n}),n},_space:function(){var e=[],t=this;return h(c,function(n,i){t[i.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var i=u(e),s=i._space(),r=c[s],o=0===this.alpha()?u("transparent"):this,a=o[r.cache]||r.to(o._rgba),l=a.slice();return i=i[r.cache],h(r.props,function(e,s){var r=s.idx,o=a[r],u=i[r],c=d[s.type]||{};null!==u&&(null===o?l[r]=u:(c.mod&&(u-o>c.mod/2?o+=c.mod:o-u>c.mod/2&&(o-=c.mod)),l[r]=n((u-o)*t+o,s)))}),this[s](l)},blend:function(t){if(1===this._rgba[3])return this;var n=this._rgba.slice(),i=n.pop(),s=u(t)._rgba;return u(e.map(n,function(e,t){return(1-i)*s[t]+i*e}))},toRgbaString:function(){var t="rgba(",n=e.map(this._rgba,function(e,t){return null==e?t>2?1:0:e});return 1===n[3]&&(n.pop(),t="rgb("),t+n.join()+")"},toHslaString:function(){var t="hsla(",n=e.map(this.hsla(),function(e,t){return null==e&&(e=t>2?1:0),t&&3>t&&(e=Math.round(100*e)+"%"),e});return 1===n[3]&&(n.pop(),t="hsl("),t+n.join()+")"},toHexString:function(t){var n=this._rgba.slice(),i=n.pop();return t&&n.push(~~(255*i)),"#"+e.map(n,function(e){return e=(e||0).toString(16),1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),u.fn.parse.prototype=u.fn,c.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,n,i=e[0]/255,s=e[1]/255,r=e[2]/255,o=e[3],a=Math.max(i,s,r),l=Math.min(i,s,r),u=a-l,c=a+l,d=.5*c;return t=l===a?0:i===a?60*(s-r)/u+360:s===a?60*(r-i)/u+120:60*(i-s)/u+240,n=0===u?0:.5>=d?u/c:u/(2-c),[Math.round(t)%360,n,d,null==o?1:o]},c.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,n=e[1],i=e[2],r=e[3],o=.5>=i?i*(1+n):i+n-i*n,a=2*i-o;return[Math.round(255*s(a,o,t+1/3)),Math.round(255*s(a,o,t)),Math.round(255*s(a,o,t-1/3)),r]},h(c,function(i,s){var r=s.props,o=s.cache,l=s.to,c=s.from;u.fn[i]=function(i){if(l&&!this[o]&&(this[o]=l(this._rgba)),i===t)return this[o].slice();var s,a=e.type(i),d="array"===a||"object"===a?i:arguments,f=this[o].slice();return h(r,function(e,t){var i=d["object"===a?e:t.idx];null==i&&(i=f[t.idx]),f[t.idx]=n(i,t)}),c?(s=u(c(f)),s[o]=f,s):u(f)},h(r,function(t,n){u.fn[t]||(u.fn[t]=function(s){var r,o=e.type(s),l="alpha"===t?this._hsla?"hsla":"rgba":i,u=this[l](),c=u[n.idx];return"undefined"===o?c:("function"===o&&(s=s.call(this,c),o=e.type(s)),null==s&&n.empty?this:("string"===o&&(r=a.exec(s),r&&(s=c+parseFloat(r[2])*("+"===r[1]?1:-1))),u[n.idx]=s,this[l](u)))})})}),u.hook=function(t){var n=t.split(" ");h(n,function(t,n){e.cssHooks[n]={set:function(t,s){var r,o,a="";if("transparent"!==s&&("string"!==e.type(s)||(r=i(s)))){if(s=u(r||s),!f.rgba&&1!==s._rgba[3]){for(o="backgroundColor"===n?t.parentNode:t;(""===a||"transparent"===a)&&o&&o.style;)try{a=e.css(o,"backgroundColor"),o=o.parentNode}catch(l){}s=s.blend(a&&"transparent"!==a?a:"_default")}s=s.toRgbaString()}try{t.style[n]=s}catch(l){}}},e.fx.step[n]=function(t){t.colorInit||(t.start=u(t.elem,n),t.end=u(t.end),t.colorInit=!0),e.cssHooks[n].set(t.elem,t.start.transition(t.end,t.pos))}})},u.hook(o),e.cssHooks.borderColor={expand:function(e){var t={};return h(["Top","Right","Bottom","Left"],function(n,i){t["border"+i+"Color"]=e}),t}},r=e.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),define("jquery.color",function(){}),define("core/sections/GroupPermissionsIndex",["require","jquery","wasabi.BaseView","common/SpinPresets","jquery.color","jquery.spin"],function(e){var t=e("jquery"),n=e("wasabi.BaseView"),i=e("common/SpinPresets");return e("jquery.color"),e("jquery.spin"),n.extend({el:".wasabi-core--grouppermissions-index",events:{"click .single-submit":"onSingleSubmit"},onSingleSubmit:function(e){e.preventDefault();var n=t(e.target);n.hide().blur().parent().spin(i.small),t.ajax({type:"post",url:this.$(".permissions-update-form").attr("action"),data:n.parent().parent().find("input").serialize(),dataType:"json",cache:!1,success:function(){var e=n.parent().parent(),i=n.parent().css("backgroundColor");n.parent().spin(!1),n.show(),e.find("td:not(.controller)").stop().css({backgroundColor:"#fff7d9"}).animate({backgroundColor:i},1e3,function(){t(this).css({backgroundColor:""})})}})}})}),define("wasabi.core",["require","jquery","underscore","core/views/Menu","core/views/NavigationToggle","core/views/LangSwitch","core/views/Pagination","wasabi","jquery.livequery","core/sections/LanguagesIndex","core/sections/GroupPermissionsIndex"],function(e){function t(){l.ajaxSetup({dataType:"json"}),l(g).ajaxSuccess(n).ajaxError(i)}function n(e,t){if(200==t.status&&"OK"==t.statusText){var n=l.parseJSON(t.responseText)||{};"undefined"!=typeof n.status&&("undefined"!=typeof n.flash&&s(n.flash),"undefined"!=typeof n.redirect&&(h.location=n.redirect))}}function i(e,t){var n;401==t.status&&(n=l.parseJSON(t.responseText)||{},"undefined"!=typeof n.name&&(confirm(n.name),h.location.reload())),500==t.status&&(n=l.parseJSON(t.responseText)||{},"undefined"!=typeof n.name&&s({before:"div.title-pad","class":"error",message:n.name}))}function s(e){var t=e.before||!1,n=e.after||!1,i=e.message,s=e["class"]?"flash-"+e["class"]:"flash-success",r=!1,o=l("<div/>").addClass(s).html(i);t?(r=l(t),r.prev("."+s).remove(),o.insertBefore(r)):n&&(r=l(n),r.next("."+s).remove(),o.insertAfter(r))}function r(){p.views.menu=p.createView(u),p.views.navigationToggle=p.createView(c),p.views.langSwitch=p.createView(d),p.views.paginations=p.createViews(l(".pagination"),f)}function o(){e("jquery.livequery"),l("select").livequery(function(){l(this).toggleClass("empty",""===l(this).val()),l(this).change(function(){l(this).toggleClass("empty",""===l(this).val())})})}function a(){this.$body.hasClass("wasabi-core--languages-index")&&p.createView(e("core/sections/LanguagesIndex")),this.$body.hasClass("wasabi-core--grouppermissions-index")&&p.createView(e("core/sections/GroupPermissionsIndex"))}var l=e("jquery"),u=(e("underscore"),e("core/views/Menu")),c=e("core/views/NavigationToggle"),d=e("core/views/LangSwitch"),f=e("core/views/Pagination"),p=e("wasabi"),h=window,g=document;return{options:{},w:null,d:null,$html:null,$body:null,views:[],collections:[],models:[],resizeTimeout:0,components:{},initialize:function(e){this.options=e||{},this.w=h,this.d=g,this.$html=l("html"),this.$body=l("body"),t.call(this),r.call(this),o.call(this),a.call(this)}}});